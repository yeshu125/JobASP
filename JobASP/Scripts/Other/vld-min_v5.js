if(!MJS.VLD){MJS.VLD={}}MJS.VLD.isValidForm=function(obj){var FRM_OBJ=(obj.FRM_OBJ?obj.FRM_OBJ:(obj.FRM_NAME?document[obj.FRM_NAME]:""));var VALIDATION=obj.VALIDATION;var IS_ALERT=(obj.IS_ALERT!=null?obj.IS_ALERT:1);var ALERT_DHTML_ID=obj.ALERT_DHTML_ID||"ErrMsgOnDHTML";var FOCUS_OBJ_ON_ERR=(obj.FOCUS_OBJ_ON_ERR!=null?obj.FOCUS_OBJ_ON_ERR:1);var RET_TYPE=(obj.RET_TYPE!=null?obj.RET_TYPE:"FLAG");var retFlag=true;var FIELD_ERR_MSG={};var objToFocus=0;for(var I=0;I<VALIDATION.length;I++){var VObj=VALIDATION[I];var FIELD_NAME=VObj.FIELD_NAME;var MSG=(VObj.MSG?VObj.MSG:"");var TRIM_SPACE=(VObj.TRIM_SPACE?VObj.TRIM_SPACE:1);var VALIDATE_TYPE=MJS.UTILS.makeArrIfNotArr(VObj.VALIDATE_TYPE);var ON_ERR_FUN=(VObj.ON_ERR_FUN?VObj.ON_ERR_FUN:"");var ON_SUCCESS_FUN=(VObj.ON_SUCCESS_FUN?VObj.ON_SUCCESS_FUN:"");var FOCUS_OBJ=(VObj.FOCUS_OBJ!=null?VObj.FOCUS_OBJ:1);var CHK_VALID_FUNC=(VObj.CHK_VALID_FUNC?VObj.CHK_VALID_FUNC:"");if(FRM_OBJ[FIELD_NAME]){LOOP_VALIDATE:for(var J=0;J<VALIDATE_TYPE.length;J++){var VType=VALIDATE_TYPE[J];if(!MJS.VLD.isValid({DATA:MJS.VLD.getValue(FRM_OBJ[FIELD_NAME]),VALIDATE_TYPE:VType,CHK_VALID_FUNC:CHK_VALID_FUNC,TRIM_SPACE:TRIM_SPACE})){eval(ON_ERR_FUN);if(MSG){if(!FIELD_ERR_MSG[FIELD_NAME]){FIELD_ERR_MSG[FIELD_NAME]=[]}FIELD_ERR_MSG[FIELD_NAME].push(MSG)}retFlag=false;if(FOCUS_OBJ&&(!objToFocus)){objToFocus=FRM_OBJ[FIELD_NAME]}break LOOP_VALIDATE}else{eval(ON_SUCCESS_FUN)}}}else{var errMsgFieldNotExist="Field name : "+FIELD_NAME+" going to check does not exists.";if(!FIELD_ERR_MSG[FIELD_NAME]){FIELD_ERR_MSG[FIELD_NAME]=[]}FIELD_ERR_MSG[FIELD_NAME].push(errMsgFieldNotExist);retFlag=false}}var ERR_MSG=new Array();if(IS_ALERT&&(!retFlag)){for(var FIELD_NAME in FIELD_ERR_MSG){if(FIELD_ERR_MSG[FIELD_NAME]){ERR_MSG.push(FIELD_ERR_MSG[FIELD_NAME][0])}}if(IS_ALERT=="DHTML"){MJS.SKR.showAlertOnDHTML({MSG:ERR_MSG.join("<br>"),ID:ALERT_DHTML_ID})}else{if(FOCUS_OBJ_ON_ERR){MJS.SKR.showAlertMsg({MSG:ERR_MSG.join("<br>"),FOCUS_OBJ:objToFocus})}else{MJS.SKR.showAlertMsg({MSG:ERR_MSG.join("<br>")})}}}if(RET_TYPE=="FLAG"){return retFlag}else{if(RET_TYPE=="FIELD_ERR_MSG"){return{SUCCESS:retFlag,FIELD_ERR_MSG:FIELD_ERR_MSG,OBJ_TO_FOCUS:objToFocus}}}};MJS.VLD.focusObj=function(A){if(MJS.UTILS.isArray(A)&&(A.length)&&(A[0].type=="radio")){A[0].focus()}else{A.focus()}};MJS.VLD.isValid=function(obj){var ALL_DATA=obj.DATA;var TRIM_SPACE=obj.TRIM_SPACE;CHK_VALID_FUNC=(obj.CHK_VALID_FUNC?obj.CHK_VALID_FUNC:"");var DATA;if(ALL_DATA!=null&&ALL_DATA.length){DATA=ALL_DATA[0]}if(TRIM_SPACE&&DATA!=null){DATA=DATA.replace(/^\s+|\s+$/g,"")}var VALIDATE_TYPE=(obj.VALIDATE_TYPE?obj.VALIDATE_TYPE:"");var isValidDataRetFlag=true;if(VALIDATE_TYPE=="NOT_NULL"){if(DATA==null||DATA.length<1){isValidDataRetFlag=false}}else{if(VALIDATE_TYPE=="NOT_START_WITH_SPACE"){if(DATA!=null&&DATA.length){if(DATA.search(/^\s/)>-1){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE=="NOT_END_WITH_SPACE"){if(DATA!=null&&DATA.length){if(DATA.search(/\s$/)>-1){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE=="ALNUM_ONLY"){if(DATA!=null&&DATA.length){if(DATA.search(/[^0-9a-z]/i)>-1){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE=="INT_ONLY"){if(DATA!=null&&DATA.length){if(DATA.search(/\D/)>-1){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE=="NON_ZERO"){if(DATA!=null&&DATA.length){if((isNaN(DATA))||(DATA==0)){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE=="POSITIVE_INT"){if(DATA!=null&&DATA.length){if((isNaN(DATA))||(DATA>0)){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE.search(/^MAX_VALUE:[0-9]/)>-1){var limit=VALIDATE_TYPE;limit=limit.replace("MAX_VALUE:","");if(!isNaN(DATA)){if(DATA>limit){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE.search(/^MIN_VALUE:[0-9]/)>-1){var limit=VALIDATE_TYPE;limit=limit.replace("MIN_VALUE:","");if(!isNaN(DATA)){if(DATA<limit){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE=="VALID_EMAIL"){if(DATA!=null&&DATA.length){if(DATA.search(/^[a-zA-Z0-9&\'\.\-_\+]+@[a-zA-Z0-9\-]+\.([a-zA-Z0-9\-]+\.)*?[a-zA-Z]+$/)<0){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE.search(/^MIN_SELECTED/)>-1){var selectedCount=VALIDATE_TYPE;selectedCount=selectedCount.replace("MIN_SELECTED:","");if((selectedCount)&&(ALL_DATA==null&&ALL_DATA.length<selectedCount)){isValidDataRetFlag=false}}else{if(VALIDATE_TYPE.search(/^MAX_SELECTED:[0-9]/)>-1){var selectedCount=VALIDATE_TYPE;selectedCount=selectedCount.replace("MAX_SELECTED:","");if((selectedCount)&&(ALL_DATA!=null&&ALL_DATA.length>selectedCount)){isValidDataRetFlag=false}}else{if(VALIDATE_TYPE.search(/^MIN_CHAR_LEN:[0-9]/)>-1){if(DATA!=null&&DATA.length){var selectedCount=VALIDATE_TYPE;selectedCount=selectedCount.replace("MIN_CHAR_LEN:","");if((selectedCount)&&(DATA.length<selectedCount)){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE.search(/^MAX_CHAR_LEN:[0-9]/)>-1){if(DATA!=null&&DATA.length){var selectedCount=VALIDATE_TYPE;selectedCount=selectedCount.replace("MAX_CHAR_LEN:","");if((selectedCount)&&(DATA.length>selectedCount)){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE=="PHONE"){if(DATA!=null&&DATA.length){if(DATA.length<6){isValidDataRetFlag=false}}}else{if(VALIDATE_TYPE=="IS_VALID_BY_FUNC"){if(CHK_VALID_FUNC){if(!eval(CHK_VALID_FUNC)){isValidDataRetFlag=false}}}}}}}}}}}}}}}}}}return isValidDataRetFlag};MJS.VLD.getValue=function(C){var D;D=new Array();if(C.type=="select-multiple"){for(var B=0;B<C.options.length;B++){if(C.options[B].selected){if((name=C.name)&&(value=C.options[B].value)){D.push(value)}}}}else{if(MJS.UTILS.isArray(C)&&(C.length)&&(C[0].type=="radio")){for(var A=0;A<C.length;A++){if(C[A].checked){if((name=C[A].name)&&(value=C[A].value)){D.push(value)}}}}else{if(C.type=="checkbox"){if(C.checked){if((name=C.name)&&(value=C.value)){D.push(value)}}}else{if((name=C.name)&&(value=C.value)){D.push(value)}}}}return D};